基于 LLM 的账务智能体-账策云帆 Bank-copilot
一、背景
- 赛题背景：赛题来源于苏州银行。银行在账务检索和账务核对存在三个关键的效率问题：非财会专业新人入门难；账务检索时会计管理人员根据分录反向穿透到账号交易明细有难度；若账务出现总分不平，因可能跨多个系统的原因，财务人员无法快速定位是哪笔交易。本赛题的核心在于实现交互式账务术语问答、账务多层检索问答、账务问题定位分析以提高账务管理人员工作效率。
暂时无法在飞书文档外展示此内容
业务场景描述
银行在账务检索和账务核对上有较高的要求，在实际使用中存在三个影响运营效率的问题： 
1. 非财会专业新人入门难。新人难以理解科目、借贷方向、余额方向等基础知识。 
2. 账务的检索根据日期的不同分为了历史检索和当日检索，且根据账号的不同要区分在不同的业务系统中进行查询，对会计管理人员根据分录反向穿透到账号交易明细上有 一定的难度，影响从交易明细到会计分录关联检索的效率。
3. 账务问题定位慢。若账务出现总分不平，因可能跨多个系统的原因，财务人员无 法快速定位是哪笔交易。 因此，亟需一套基于大语言模型对账务数据特征训练后的智能体，实现交互式账务术语问答、账务多层检索问答、账务问题定位分析以提高账务管理人员的工作效率。

赛题要求： 
总体目标：构建一套基于大语言模型对账务数据特征训练后的智能体。 
技术任务： 
1. 使用知识获取与构建技术搭建账务知识库，依据 LLM 平台，构建知识 
库问答智能体。做到能够精准的描述账务体系的基础组成，以及其他 
关键术语的概念及作用。能够通过文本对话的方式指导刚接触账务的 
员工快速学习行内账务相关知识，降低员工频繁查阅不同文档造成时 
间成本 
2. 针对超过 20 轮复杂对话中的信息衰减问题，构建可持续跟踪的业务意 
图理解。开发记忆强化网络，通过注意力权重动态筛选关键信息，解 
决长对话中的信息衰减问题。构建干扰信息过滤模块，自动识别并忽 
略与业务无关的闲聊内容。能够通过对话的方式获取到多维度的信息， 
降低会计使用人员在维度信息获取上的沟通成本。 
3. 使用推理与决策技术根据总分不平科目，检索出对应的日期、机构、 
币种、金额，再进一步往上追溯该科目相关的发生明细，进而推理出 
总分不平的可能性原因。根据总分核对异常结果，能够进行深度思考 
并通过实际数据给出可能造成的原因，降低会计人员定位总分核对异 
常的分析时间成本。 
配套数据情况： 
- 数据规模：分户余额数据约 2 亿条，会计分录数据约 1 亿条，交易明细数 
据约 700 万条，总分核对结果数据约 60 万条。 
- 数据类型：纯文本格式的结构化数据。 
- 时间区间：2025 年 6 月 1 号-2025 年 6 月 10 号。
- 目标：
- 预期效果：
- 相关资料：输入@ 插入相关云文档
- 提交内容：初赛参赛者需提交以精益画布呈现的参赛成果说明和附件，附件包括但不限于作品原创性声明、 参赛团队合影等，可选择提交必要的技术文档、可运行的项目成果（如模型源代码、系统演示包）中的至少一项。
二、实施策略
2.1 实施方案
描述项目的实施方案和计划，为项目组成员提供背景信息
- 金融组
- 技术组

2.2 项目时间线
鼠标悬浮在流程图上，点击“编辑”按钮进入全屏模式编辑流程图
暂时无法在飞书文档外展示此内容

三、赛题拆解
技术攻关问题描述（针对应用层面的难点问题，用一段话总结技术层面需要解决的关键卡点堵点问题，若该业务瓶颈/应用难点下存在多个技术问题则分条表述）
1. 能够通过文本对话的方式指导刚接触账务的员工快速学习行内账务相关知识，降低员工频繁查阅不同文档造成时间成本。因此需搭建一套财务知识的专业知识库，主要存在以下难点：
  1. 如何从多源数据中提取信息（如word、表格、图片、pdf等）
  2. 数据可能存在重复、错误、缺失或过时，如何清洗和验证
  3. 如何进行知识存储以及提升检索效率提升
  4. 知识的更新与维护机制建立

2. 长对话场景下的上下文意图持续性理解，根据前后文向上追溯，可根据某一维度信息逐步通过对话的方式获取到多维度的信息，降低会计使用人员在维度信息获取上的沟通成本。主要存在以下难点：
  1. 上下文长度限制导致的意图断层问题
  2. 跨轮次逻辑关联问题（如前面根据账号维度提问后，再通过科目进行提问，两个提问会涉及两个维度数据的相互关联，模型需捕捉深层）
  3. 多轮对话的语境积累，长期对话中可能涉及多项主体的问题，模型需维持各阶段语境的独立性与整体连贯性
  4. 长序列计算开销问题，处理长对话时，token数增加导致计算量指数级上升，实时对话场景下可能因延迟影响意图理解的连续性
  5. 需设计轻量化机制，使模型能高效增量学习新对话上下文，而非每次重新处理全量历史信息


3. 根据总分核对异常结果，能够进行深度思考并通过实际数据给出可能造成的原因，降低会计人员定位总分核对异常的分析时间成本。主要存在以下难点：
  1. 如何通过减少计算量提升长序列处理效率
  2. 如何设计并行计算架构，加速推理过程
  3. 如何用小模型学习大模型的输出分布，在轻量化的同时保留核心推理能力
  4. 如何将高精度参数压缩为低精度，减少存储和计算开销，同时通过量化感知训练保持精度
  5. 如何设计推理优化策略（如动态批处理、增量推理等）
  6. 如何设计内存管理策略（如分页、参数卸载与交换等）
  7. 如何加速推理引擎，减少算子调用开销 
  8. 如何针对生成任务优化调度策略，提升吞吐量 
  9. 如何设计提示词优化，引导模型生成更准确的结果


攻关任务描述
任务1：账务知识库搭建 
使用知识获取与构建技术搭建账务知识库，依据LLM平台，构建知识库问答智能体。做 到能够精准的描述账务体系的基础组成，以及其他关键术语的概念及作用。做到如下要求： 
a) 能够从多源数据样本获取数据 
b) 对重复、错误、过时的数据进行清洗 
c) 通过技术设计（如高效索引、缓存、数据分片、数据压缩等）提升数据检索效率 
d) 利用监督学习（如SVM、随机森林等）或无监督学习（如聚类算法），根据历史数 
据训练模型，自动判断内容归属类别，减少人工标注成本，进行知识的更新与维护。 

任务2：长对话上下文管理引擎构建 
针对超过20轮复杂对话中的信息衰减问题，构建可持续跟踪的业务意图理解。 
开发记忆强化网络，通过注意力权重动态筛选关键信息（如账号、流水号、科目、金额、币种、借贷方向等）。 构建干扰信息过滤模块，自动识别并忽略与业务无关的闲聊内容。做到如下要求： 
a) 使用长文本专用模型（如Longformer、BigBird等）通过稀疏注意力机制降低长文本 
计算复杂度 
b) 多轮对话意图链构建（如意图关联图谱、显式意图标记等） 
c) 分段对话管理与上下文切分 
d) 对话状态追踪和结构化存储（如显式状态建模、事件图谱构建等） 
e) 增量式上下文更新和注意力增强（如增量编码策略、动态注意力权重等）
 
任务3：账务总分问题推理 
使用推理与决策技术根据总分不平科目，检索出对应的日期、机构、币种、金额，再进 一步往上追溯该科目相关的发生明细，进而推理出总分不平的可能性原因。做到如下要求： 
a) 建立高效注意力机制（如稀疏注意力等），通过减少计算量提升长序列处理效率（ 
如LongFormer模型等） 
b) 能够利用张量计算、流水线并行等技术，将模型分层部署，加速推理过程 
c) 模型量化，将高精度参数压缩为低精度，减少存储和计算开销，并保持精度。 
d) 知识蒸馏，用小模型学习大模型的输出分布，轻量化的同时保留核心推理能力。 
e) 利用动态批处理和增量推理技术，实现推理优化 
f) 利用内存管理技术，实现动态内存分配，避免因内存不足导致的推理中断 
g) 利用引擎优化计算图（如TensorRT等），减少算子调用开销。 
h) 通过设计高效提示词（如少样本学习、思维链提示等），引导模型生成更准确的结果



四、任务目标
总体目标：实现通过自然语言问答的智能交互界面，用户进行账务知识的提问、学习； 
账务管理人员可以通过任意维度的信息，以问答的方式获取全面的会计账务明细，并可以通 
过上下文信息进行总结；用户可以查询总分不平的结果，并向用户提供可能造成总分不平的 
原因以及推理思考路径。 

针对任务1：账务知识库搭建 
- 技术指标：问答准确率>=90%；响应时间<=10ms/单。 
- 预期目标：搭建账务知识库并支持增量学习。 
- 成果交付：知识库本体（如知识图谱、数据库等）、智能交互接口（如聊天机器人界 
面、API接口文档等）、知识处理组件（如数据处理脚本、自动化更新流程文档等）。 

针对任务2：长对话上下文管理引擎构建 
- 技术指标：20轮对话意图连贯性保持率≥90%，多意图嵌套场景处理准确率≥85%，干 
扰信息过滤有效率≥95%（闲聊内容误拦截率≤3%），平均响应时间<=200ms，峰值延迟<=50 
0ms。 
- 预期目标：用户可通过任一账务数据的维度，通过多轮对话的方式逐步获取其他维度 
的信息，并可对多轮会话的结果信息进行总结。 
- 成果交付：上下文存储与提取能力报告、语义连贯性测试用例及结果、规则引擎配置 
手册、上下文遗忘机制验证文档、成果演示文档。

针对任务3：账务总分问题推理 
- 技术指标：推理准确率>=80%，单轮推理耗时<=500ms； 
- 成果交付：智能体架构设计文档、代码与最终模型、测试验证报告、部署手册、算法 
专项指标、成果演示文档。




五、画布
1. 技术问题回顾
本项目旨在构建一个银行账务智能体，其技术攻关的核心在于解决三大融合性难题：首先，需实现从多源异构数据中自动化构建、更新并能高效检索的领域知识库，以支撑精准的术语问答。其次，必须克服长对话场景中的信息衰减与意图断层，通过动态筛选关键信息与过滤无关内容，确保业务意图在超过20轮的复杂交互中得以持续、连贯地理解。最后，面对海量账务数据，智能体需具备多步骤追溯与深度推理能力来定位“总分不平”的根本原因，并综合运用模型压缩、推理优化与引擎加速等技术，在保证分析准确性的同时，实现生产环境下的高效与低延迟响应。

2. 核心解题思路
采用多智体架构，利用文件系统和知识图谱对多轮对话进行动态建模，以用户为中心进行记忆构建和提取，


3. 解决方案详述
3.1 第一问：员工培训智能体系统
1. AI智能体生成交互式课程
  - 工作流：解析教材→设计课程结构→调用组件（问答/流程图等）→审核输出。
  - 工具：基于开源LLM，支持 PDF/Word 等培训手册自动转化为教学课程。
2. 设计原则
  - 结构分层：参考“Learn（理论）+ Build（实践）”模式。
  - 人机协作：AI生成内容需人工核对重难点（避免知识脱节）。
多智体协同

- 微服务架构
- 流式计算引擎
cdc


Agentic RAG 智能体增强知识库
知识检索助手
RAG 知识库检索 92%

主动思考
Active Reasoning
深度智能体 2.0


3.2 第二问：基于知识图谱的对话实时建模

记忆架构：分层构建的层次化记忆无法整合分散在多轮对话中的零散信息，而基于知识图谱的结构化记忆虽然可以通过结构化关系提升记忆效果，但由于通常 AI 与人类的原始对话中充斥一部分噪音，信息杂乱，而知识图谱的提取对输入质量极其敏感，原始对话需要进行提纯后才能将其保存为记忆。为此我们综合“层次化记忆+结构化记忆”，从原始对话中提取事实来构建分层记忆，再将加工后的深层记忆转化为结构三元组载入知识图谱构成结构化记忆。检索采用 4 通道混合召回（关系、实体、原始片段、主题集群）每个通道融合 embedding 与关键词匹配，以实现性能的均衡。

层次化记忆：更好地筛选有用信息  （筛选剔除噪音+存取）
结构化记忆：更好地提取有关联的记忆 （把记忆之间的关系串联起来，做到每次能仅仅把有关联的记忆提取出来）


3.3 第三问



f()
模块
1. 知识库：手册展览
2. 智能对话：
3. 账务查询：日期->当天账务不平->查看



4. 项目技术亮点

4.1 个性化员工培训
平台配备用户鉴权功能，后台记录每位员工学习进度，全程持续跟进用户学习偏好并基于偏好设计课程，针对不同职位以及不同水平员工设计个性化教学内容及测验。极大降低企业员工培训成本。

4.2 动态压缩+上下文工程
后台异步压缩对话历史，剔除与对话任务无关信息。利用上下文工程管理会话窗口，最大限度激发模型思维能力。

4.3 记忆外脑
用户的在 AI 平台上的行为与企业内部的资料都能被转化为一整套记忆网络。
4.3.1 具备时间维度的记忆网络
使用双时态数据模型构建记忆网络中的每一个记忆节点，即每一个记忆节点在被创建时就会被标上时间标签，当下一次被激活时会根据他的时效性来判断长短期记忆，过期的记忆信息将被自动标记为无效并过滤掉，这保证了智能体的记忆是对用户最近的记忆并实时更新以捕捉用户偏好的转变。

4.3.2 不同记忆格式
将记忆分为不同类型进行存储。（短期、长期、会话、偏好、事实）

图内存：存储实体关系以实现多跳调用。
高级元数据过滤：使用逻辑运算符和嵌套条件进行查询。
搜索重排序：利用专用模型提升搜索相关性。
异步内存操作：适用于高吞吐量应用的非阻塞操作。
多模式支持：处理图像、音频和视频存储器。
自定义事实提取：调整从文本中提取事实的方式。
自定义内存更新：通过自定义指令控制内存优化。

4.4 在线分析处理 (OLAP)数据库构建毫秒级响应
百亿级复杂查询分析压缩在几秒内完成。

4.5 人机协同办公，规范 AI 权限
智能体在执行关键操作之前都会向员工进行确认，在征得用户同意后才会进行后续操作，以保证操作安全。

4.6 数据分析智能体
打造原生沙盒环境运行时帮助智能体在隔离环境下进行数据分析，更好的帮助员工洞察数据。

5. 落地可行性
5.1 部署性能
我们的记忆提取框架使用高性能图数据库 FalkorDB 作为多智能体环境的图数据库后端。此集成满足了生产环境中 AI 智能体部署的性能和隔离要求。 Graphiti 构建具有时间感知能力的知识图谱，表示实体之间随时间演变的关系。Graphiti 的独特之处在于它能够自主构建知识图谱，同时处理不断变化的关系并保持历史背景。该框架通过其情景记忆架构处理非结构化对话数据和结构化业务数据。每个事实都包含有效时间戳和无效时间戳，使智能体能够跟踪用户偏好和环境条件的变化。
构建多智能体系统的开发者无需更改现有智能体逻辑的架构，即可受益于更低的查询延迟和租户隔离。该集成保留了 Graphiti 的 API 接口和时间数据优势，同时利用了 FalkorDB 的性能优化。这种组合确保了上下文在业务和时间上都保持相关性。 

这种整合是解决以下问题的关键：
- 智能体知识冲突
多个 AI 智能体在未进行适当隔离的情况下访问共享知识图谱，会给您的项目和业务带来风险，尤其是在规模扩大时。FalkorDB 的租户隔离功能为每个智能体提供专用的图实例，同时共享计算资源，从而消除更新冲突，且无需增加基础设施重复成本。
- 查询延迟瓶颈
知识密集型智能体需要低于 10 毫秒的响应时间才能执行多跳推理查询。与其他图提供商相比，跨数百万个节点的图遍历操作可能会超出可接受的延迟阈值，从而严重影响用户体验。FalkorDB 的稀疏矩阵表示将查询执行时间从秒级缩短到毫秒级，从而实现智能体的实时交互。
“该技术架构能够高效地支持我们的情景记忆模型。FalkorDB 的租户隔离实现方案支持并发智能体操作，同时保持我们生产部署所需的亚毫秒级响应时间。”

需要内存、上下文信息和流畅用户体验的应用将率先受益于此次合作。以下是一些实际应用案例：
- 客户服务多智能体团队
多个客服人员同时处理客户交互，需要访问产品目录、支持历史记录和策略数据库。每个客服人员在访问共享产品知识的同时，还能维护特定客户的上下文信息。FalkorDB 可防止客服人员访问其他客户的数据，从而在保护隐私的同时，支持共享产品关系查询，即使您的业务规模不断扩大也能如此。
- 企业知识管理
企业会为不同部门（人力资源、法务、工程）部署专门的智能体，以访问重叠但受限的知识领域。智能体需要能够访问特定部门的公司知识，且避免交叉污染。FalkorDB 的多租户架构确保了合规边界，同时支持授权的跨部门知识共享。


5.2 大中型银行机构
- 私有化本地部署
- 定制化产品
- 数据本地化

业务量巨大,合同类型繁多
频繁面临法律和合规更新的压力
具有较高的购买力

5.3 中小型银行机构
- 一体机租赁
- 预先部署好GPU和大模型
- 有限预算下的数据本地化

年合同审查量较大
合规要求与数据安全性要求较高
预算相对充足,但不具备私有化部署能力

5.4 小型银行机构

小微型金融机构/企业
Saas模式
合同管理需求简单
不需要定制化的系统
倾向低成本的标准化产品
线上订阅基于Web的软件
无需购买和维护基础设施



6. 缺点以及未来改进方案
- Token 消耗过大：
多智体框架以及知识图谱的实时维护对 token 消耗非常大，未来将优化提示词设计以及




7. 测试结果


7.1 记忆
我们使用LongMemEval对 Bank-Copilot 与传统全上下文进行测试。LongMemEval 是一项全面且具有挑战性的聊天历史记录内存评估测试，能够更好地反映真实的企业使用场景。在该基准测试中，Bank-Copilot 的总体准确率提升高达 18.5%，单次评估结果显示，与在上下文窗口中使用完整聊天记录相比，Bank-Copilot 的准确率提升超过 100%，同时响应延迟降低了 90%。
值得注意的是，与较小的模型相比，Bank-Copilot 与 DeepSeek 作为智能体层级模型 (LLM) 搭配使用时，其相对于“大海捞针”式基线模型的性能优势更为显著。虽然基线模型在与 Qwen3 相比时有所改进，但较大的模型能更有效地利用 Bank-Copilot 的时间上下文信息。


1. 介绍
Bank-copilot 是一个超越 FinGPT 范畴的 AI 智能体平台，是专为银行内部业务精心设计的综合解决方案。它集成了多种 AI 技术，超越了单纯的语言模型。这种广阔的视野凸显了平台的多功能性和适应性，能够满足银行行业的多方面需求。
随着银行机构和专业人士越来越多地将大型语言模型 (LLM) 纳入其工作流程，银行部门和人工智能社区之间仍然存在着巨大的障碍，包括专有数据和专业知识。这些挑战阻碍了人工智能社区有效增强银行任务的能力。认识到银行分析的关键作用，我们的目标是设计基于 LLM 的银行专业多智能体系统，结合当前工业界最前沿的 AI 技术以及算法，促进人工智能在银行决策中的更广泛应用。在本文中，我们将介绍  Bank-copilot，一个新颖的开源人工智能智能体平台，支持多个由 LLM 驱动的银行专业人工智能智能体。具体而言，该平台由四个主要层组成：
1）银行 AI 智能体层，通过将复杂的银行问题分解为逻辑序列来制定银行思路 (CoT)；
2）银行 LLM 算法层为特定任务动态配置适当的模型应用策略；
3）LLMOps 和 DataOps 层通过应用训练/微调技术和使用与任务相关的数据来生成准确的回复； 
4）多源 LLM 基础模型层，集成各种 LLM 模型，使上述各层能够直接访问它们。
最后， Bank-copilot 为专业级分析师和非专业人士提供了实践机会，使他们能够利用强大的 AI 技术进行高级财务分析。


1.1 深度 Agent —— 智能体 2.0 
当前的 AI 应用开发中，最简单也最常见的智能体架构是“在循环中调用工具的 LLM”。这种架构虽然简单直接，但在实际应用中却往往难以突破“浅层”的天花板——就像短跑选手难以完成马拉松比赛一样。
这种局限性在实际应用中表现为：
- 难以维持长时间的任务专注度，容易“走神”或“忘记”初始目标
- 无法有效管理复杂的上下文信息，信息量增大时表现急剧下降
- 在多步骤任务中容易迷失方向，难以从错误中恢复
- 难以深入探索特定领域的细节，往往只能提供表面分析
然而，像 Claude Code、Manus 和 OpenAI 的 Deep Research 等应用却成功突破了这些限制。它们不再是简单的对话机器人，而是能够执行复杂任务、进行深度思考的“深度智能体”。
有趣的是，这些深度智能体的核心算法与浅层智能体并无本质区别，它们同样是“在循环中调用工具的 LLM”。真正的差异在于它们采用了四大关键组件，使传统架构焕发出新的生命力。
使用如Todo list —> markdown的方法深度智能体将规划与执行分离，并管理上下文窗口外部的内存。该架构由四大支柱组成。 
1.1.1 明确规划 
浅层智能体通过思维链进行隐式规划（“我应该先做 X，然后做 Y”）。深层智能体使用工具来创建和维护明确的计划，该计划可以作为 Markdown 文档中的待办事项列表。 在每个步骤之间，智能体都会审查并更新此计划，将步骤标记为待处理、进行中、已完成或添加注释。如果某个步骤失败，它不会盲目重试，而是会更新计划以适应失败。这使智能体能够专注于高级任务。 
1.1.2 分层授权（子智能体） 
复杂的任务需要专业化。浅层智能体试图在一次操作中成为万事通。深层智能体则采用协调器 → 子智能体的模式。 协调器将任务委托给子智能体，每个子智能体都拥有清晰的上下文。子智能体（例如“研究员”、“程序员”、“编写者”）执行其工具调用循环（搜索、出错、重试），编译最终答案，并仅将合成的答案返回给协调器。 
1.1.3 持久内存 
为了防止上下文窗口溢出，深度智能体利用外部存储源（例如文件系统或向量数据库）作为其真实来源。Claude Code 和 Manus 等框架允许智能体read访问write这些存储源。智能体写入中间结果（代码、草稿文本、原始数据）。后续智能体引用文件路径或查询，仅检索必要内容。这将范式从“记住一切”转变为“知道在哪里查找信息”。 
1.1.4 上下文工程 
上下文工程是指构建动态系统，以正确的格式提供正确的信息和工具，从而使人工智能应用能够完成任务。上下文可以从两个关键维度来描述：
1. 通过可变性：
- 静态上下文：在执行过程中不会改变的不可变数据（例如，用户元数据、数据库连接、工具）
- 动态上下文：随着应用程序运行而演变的可变数据（例如，对话历史记录、中间结果、工具调用观察结果）
2. 按生命周期：
- 运行时上下文：数据作用域限定于单次运行或调用。
- 跨对话上下文：在多个对话或会话中持续存在的数据
运行时上下文指的是本地上下文：代码运行所需的数据和依赖项。它不指：
- LLM 上下文，即传递给 LLM 提示的数据。
- “上下文窗口”，即可以传递给 LLM 的最大令牌数。
运行时上下文是一种依赖注入形式，可用于优化 LLM 上下文。它允许在运行时向工具和节点提供依赖项（例如数据库连接、用户 ID 或 API 客户端），而不是将其硬编码。例如，您可以使用运行时上下文中的用户元数据来获取用户偏好设置，并将其提供给上下文窗口。
LangGraph 提供了三种管理上下文的方式，结合了可变性和生命周期两个维度：
暂时无法在飞书文档外展示此内容
静态运行时上下文
静态运行时上下文表示不可变数据，例如用户元数据、工具和数据库连接，这些数据在运行开始时通过context参数invoke/传递给应用程序stream。这些数据在执行期间不会改变。

[图片]
暂时无法在飞书文档外展示此内容


2. 功能特性
2.1 员工交互式培训系统
教科书是教育的基石，但它们存在一个根本性的局限：它们是一种千篇一律的媒介。手工编写教科书需要耗费大量的人力，因此它们缺乏不同的视角、多样化的形式和个性化的版本，而这些恰恰是提高学习效率和吸引力的关键所在。在谷歌，我们正在探索如何利用生成式人工智能（GenAI）自动生成替代的呈现方式或个性化的示例，同时又能保持原始材料的完整性。试想一下，如果员工能够自主塑造学习路径，探索符合自身不断变化的需求的各种学习材料，那会是怎样一番景象？如果我们能够重新构想教科书，使其像每个学习者一样独一无二，那又会是怎样一番景象？
生成式人工智能 (GenAI) 的最新进展正使这一愿景更接近现实。今天，我们很高兴地向大家介绍“Bank-Copilot”项目，旨在探索生成式人工智能如何革新企业员工培训，为每位员工创造更高效、更具吸引力、以学习者为中心的学习体验。

1. AI智能体生成交互式课程
  - 工作流：解析教材→设计课程结构→调用组件（问答/流程图等）→审核输出。
  - 工具：基于开源LLM，支持PDF/教科书自动转化。
设计原则与风险提示
1. 关键原则
  - 结构分层：参考“Learn（理论）+ Build（实践）”模式。
  - 人机协作：AI生成内容需人工核对重难点（避免知识脱节）。
  - 伦理安全：教学中强调AI偏见防范与数据隐私（参考谷歌责任模块）。
2. 风险注意
  - 内容可信度：AI生成的教案/作业需验证准确性（案例：员工提交AI生成作业被识破）。
  - 技术依赖：过度自动化可能削弱教师主导性，建议作为辅助工具

对于某些内容表示形式，例如思维导图和时间轴，可以直接利用 LLM 的强大功能。而其他功能，例如带旁白的幻灯片，则需要更复杂的流程，将多个专用 AI 智能体和工具整合在一起，才能达到有效的教学效果。最后，一些特殊任务，例如生成有效的教育视觉素材，即使对于最先进的通用图像模型来说也极具挑战性。为了克服这一难题，我们专门针对生成教育插图对一个专用模型进行了微调。强大的基础模型、多步骤的智能体工作流程以及经过微调的组件相结合，使我们能够生成各种高质量的多模态学习表示形式。

2.1.1 内容转换管道
在个性化之后，系统生成多种内容表示形式，每种都旨在支持不同的学习偏好和认知过程：
沉浸式文本：此中心视图将个性化文本与动态、交错的组件集成：
- 时间线可视化用于顺序内容
- 记忆辅助工具生成上下文助记符
- 视觉插图由专门针对教育图表进行训练的精细调优 AI 模型创建
- 嵌入式问题将被动阅读转化为主动参与
替代模式：系统生成互补视图，包括：
- 带有可选 AI 生成旁白的幻灯片演示
- 带有模拟师生对话的音频图形课程
- 具有分层信息结构的交互式思维导图
2.1.2 评估整合
练习和评估组件贯穿整个体验：
$$\text{形成性评估} = \text{嵌入式问题} + \text{章节测验} + \text{即时反馈}$$
这些元素提供连续的反馈循环，使学习者能够监控他们的理解并相应地调整他们的学习策略。
2.1.3 意图识别
暂时无法在飞书文档外展示此内容

2.1.4 知识问答测评




2.2 记忆
随着智能体在我们日常生活中日益普及，它们将需要访问涵盖用户交互、业务运营和世界事件等各个方面的大量且不断演变的数据。数据不断扩展，虽然我们看到LLM上下文窗口大小迅速增加，召回能力也得到提升，但研究表明，召回仍然是一个挑战。即使这个问题最终得到解决，处理数百万个词元的上下文窗口所需的计算量，以及由此产生的延迟和功耗，对于许多实际应用场景而言仍然难以实现。
在开发 AI 应用时，多轮对话或输入内容过多导致模型回答质量下降，是每位开发者要面对的头疼问题。
Bank-copilot 综合了多种当前业界前沿解决方案，让 AI 模型在复杂场景下依然保持高质量输出。
- 基于 LangGraph 框架，逐一实现信息检索、智能筛选、上下文隔离等核心技术。
- 基于 Graphti 为动态环境中的 AI 智能体打造时间感知的知识图谱，给需要实时处理变化数据的 AI 开发者提供开源解决方案。Graphiti 是一个基于时间知识图谱的 AI 智能体记忆层，它能够持续地从用户交互和不断变化的业务数据中学习。通过为智能体提供每个用户的完整、整体视图，Graphiti 使开发人员能够构建处理复杂、个性化任务的应用程序。
- 基于 Mem0 构建多层次记忆框架，更好地提取用户偏好，适应个性化需求。
GitHub：github.com/langchain-ai/how_to_fix_your_context
主要内容：
- RAG 检索增强生成：智能检索相关信息提升回答质量；
- 工具加载策略：根据查询语义动态选择相关工具避免混乱；
- 上下文隔离：多智能体系统中为每个专家分配独立上下文；
- 上下文修剪：移除无关信息，将 25k token 压缩到 11k；
- 上下文摘要：保留关键信息同时大幅压缩内容长度；
- 上下文卸载：通过外部存储管理信息，支持跨会话记忆。
每个解决方案都提供了完整的实现教程和代码示例，值得每位开发 AI 应用的工程师学习参考。
详细见：Memory

2.2.1 结构化记忆
Zep 能够根据代理用户交互和不断演变的业务数据自动构建一个时间知识图谱。该知识图谱包含与用户和业务环境相关的实体、关系和事实。Zep 的设计灵感来源于GraphRAG，但与 GraphRAG 不同的是，Zep 能够深入理解信息随时间推移的演变过程。随着事实的改变或被取代，知识图谱也会随之更新，以反映新的状态。
[图片]
[图片]
[图片]
[图片]
[图片]

Graphiti是 Zep 内存层背后的底层技术。它是一个开源库，用于构建动态的、具有时间感知能力的知识图谱，以表示实体之间随时间演变的复杂关系。Graphiti 可以处理非结构化和结构化数据，生成的图谱可以通过融合时间、全文、语义和图算法等方法进行查询。

深度记忆检索评估的局限性
与 MemGPT 团队使用递归转录摘要进行基线评估的方法不同，我们通过在上下文窗口中包含完整的评估对话来测试深度记忆检索 (DMR) 基准。DeepSeek-V3 和 Qwen3 模型都取得了优异的成绩，超过了 MemGPT 报告的结果。这表明测试文本的长度和复杂度不足以对当代语言学习模型 (LLM) 或智能体需要解决的复杂问题进行充分评估。
2.2.2 LongMemEval：一个高质量、具有挑战性的对话数据集
LongMemEval 数据集包含500 个由人工精心挑选的问答对，答案嵌入在可扩展的用户助手聊天记录集中。该数据集旨在测试除简单事实回忆之外的其他能力，其中包含许多需要复杂时间推理的任务。
暂时无法在飞书文档外展示此内容

由于 DeepSeek 的 128,000 个标记上下文窗口的限制，我们选择使用 LONGMEMEVAL_S 数据集（每个问题包含大约 115,000 个标记），而不是更大的 LONGMEMEVAL_M 数据集（每个问题包含 1,500,000 个标记）。
我们的评估方法
我们简化了 LongMemEval 团队提出的测试方法，与我们使用 DMR 基准测试的工作类似，我们以放置在上下文窗口中的完整聊天历史记录作为基准。
[图片]
基线评估方法
在使用 Zep 时，我们首先利用 Zep 内置的消息加载功能导入聊天记录数据集。Zep 服务内部使用 DeepSeek-V3 构建知识图谱。为了评估 Zep 的性能，我们使用未经修改的测试题查询 Zep，Zep 返回了以上下文字段形式表示的相关记忆。然后，我们将该上下文字段与问题一起添加到提示中，并传递给 LLM。
[图片]
Zep检索和评估方法
然后，我们使用LLM作为评委，将结果与黄金标准进行比较。
擅长企业关键任务
Zep 能够维护事实的多个时间版本，追踪信息变化的谱系，并自动构建知识演变的历史叙述，这使得它与当前最先进的智能体记忆方法以及 RAG 的高级方法都截然不同。
如下所示，Zep 的时间知识图谱的相关结果使智能体能够推理因果关系，跟踪思想和事实的演变，并理解变化的背景——这些能力远远超出了简单的事实检索。
暂时无法在飞书文档外展示此内容
这些结果在跨会话信息合成和长期上下文维护等企业关键任务中尤为显著，证明了 Zep 在实际应用中的部署有效性。对于单次会话辅助问题，性能的下降——DeepSeek-V3 下降了 17.7%，Qwen3-32B 下降了 9.06%——与 Zep 一贯的持续改进形成了鲜明对比。针对这个问题，我们通过在单次会话中对上下文窗口中提示词的有效管理很好的将准确率维持在原先水平。
Zep的性能随模型能力而提升
Zep 的性能提升幅度相对于基准模型“大海捞针”的结果而言更大，且随着模型能力的提升而增加。当 Zep 与 DeepSeek-V3 搭配使用时，总体性能较基准模型提升了 18.5%，而与 Qwen3-32B 搭配使用时，性能提升幅度为 15.2%。
我们认为这是因为更大的模型能够更好地利用Zep记忆结果的密度和时间复杂性。随着前沿模型的演进，我们期望能够进一步提高Zep记忆结果的信息密度，从而充分利用这些模型增强后的能力。我们期望模型能力的提升能够显著提高图构建的准确性，从而实现更复杂、更细致的关系映射。


2.3 财务助理
2.3.1 总分不平查账流程
暂时无法在飞书文档外展示此内容

暂时无法在飞书文档外展示此内容
3. 欺骗性检测
大型语言模型 (LLM) 在客户支持、教育和医疗保健等应用中与全球数百万人互动。然而，它们可能有意或无意地产生欺骗性输出，这构成了严重的安全隐患。LLM 行为的不可预测性，加上针对幻觉、错误信息和用户操纵的防护措施不足，使得其滥用成为一个严重的现实风险。
我们根据 LLM 在对话中参与欺骗的程度，使用信念错位指标来量化欺骗。鉴于对话中的欺骗行为是随着交互历史而发展的行为，其有效评估和缓解需要超越单句分析。我们引入了一种多轮强化学习方法来微调 LLM，以减少欺骗行为，与其他指令调整模型相比，欺骗行为减少了 77.6%。


4. 智能体安全
4.1 二元法则
从宏观层面来看，“智能体二法则”指出，在稳健性研究能够可靠地检测和拒绝即时注入之前，智能体在一个会话中必须满足以下三个属性中的不超过两个，以避免即时注入造成最大的影响后果。
[A]智能体可以处理不可信的输入
[B]智能体人可以访问敏感系统或私人数据
[C]智能体可以改变状态或与外部通信
仍然有可能所有三个属性都是执行请求所必需的。如果智能体在不启动新会话（即，不使用全新的上下文窗口）的情况下需要所有三个属性，则不应允许该智能体自主运行，至少需要监督——通过人为审批或其他可靠的验证方式。
一个真正有用的 AI 助理，本质上需要同时拥有三种强大的能力：

- A. 处理不可信的输入
AI 可以读取它无法控制和预测的外部信息。比如，任何人发来的邮件、网上的文章、用户输入的任意一段话。
- B.访问敏感系统或私有数据
AI 能访问到你的敏感信息。比如，你的私人相册、公司的保密文档、你的密码库、甚至是生产环境的服务器。
- C.改变系统状态或对外通信
AI 能“动手”干活。比如，删除文件、发送邮件、下单买东西、调用 API。

“二权法则”的核心思想是：
一个 AI 智能体在一次会话中，绝对不能同时拥有 [A]、[B]、[C] 这全部三种能力。你最多只能“三选二”。
这就像一个安全取舍。我们来看看三种安全的组合：

1. 组合一 (A + C)：较低风险
场景： 允许 AI 读取一个公开网页（A），然后帮我写个总结并发邮件给我（C）。
为什么安全？ 因为它全程碰不到我的私有数据（B）。就算网页内容是恶意的（比如一个注入攻击），它顶多就是发个垃圾邮件，但它偷不走我的密码。

2. 组合二 (A + B)：较低风险
场景： 允许 AI 读取一个我刚收到的“不可信”邮件（A），然后帮我检索我的私有通讯录（B），看看这人是谁。
为什么安全？ 因为它不能“动手”（C）。它只能看，但不能把“邮件内容”和“通讯录信息”一起打包发给黑客。它是个“只读”助手。

3. 组合三 (B + C)：较低风险
场景： 允许 AI 访问我的私有日历（B），然后帮我给我的同事发邮件（C）协调会议时间。
为什么安全？ 因为它不处理“不可信”的外部输入（A）。所有的数据源和操作对象都是我内部可信的。

那么，什么时候最危险？
当 A + B + C 同时出现时——这就是“危险”区间。

场景： AI 读取了一封来自陌生人的、包含恶意注入攻击的邮件（A），然后AI被“说服”去访问你的私有文件（B），最后把这些文件内容通过网络请求（C）发送给了黑客。
那如果我的任务必须同时用到 A、B、C 呢？ 比如，我想让 AI “读取我这封（A）刚收到的带附件的邮件，从我的（B）私有云盘里找出相关项目资料，然后（C）把它们一起发给客户。”
“二权法则”给出的答案是：可以，但 AI 不能“自主”完成。
它必须停下来，弹出一个窗口，由“人类”来最终确认（Human-in-the-Loop）。你必须亲眼看到 AI 打算干什么，然后按下那个“批准”按钮。
所以如果你开发 AI Agent 的话，别想着花大量精力造一个无所不能、同时又刀枪不入的“完美助理”了，而必须在“能力”和“安全”之间做出取舍。
这也是一种成熟负责任的工程思维：我们必须在承认技术局限性的前提下，去设计安全的系统。
所以，当你下次看到一个 AI 产品宣称它既能全网漫游、又能管理你所有隐私、还能全自动帮你搞定一切时，你可能要多问一句：
它是怎么做到“三选二”的？如果它宣称“三权全有”，那它凭什么保证自己不会在某天被一封垃圾邮件“策反”呢？
这个“二权法则”当然也不是终点。它只是当下（2025年）我们能拿出的最靠谱的安全方案。未来我们或许会找到更好的方案，但在那之前，先设计好安全方案，总归是没错的。
[图片]

4.2 智能体护栏
如何确保智能体（比如各种自动化助手、对话机器人之类的系统）不会出什么幺蛾子，一切都在安全、可控的范围内运行？AI 科普达人 New Manchina 这期将介绍智能体安全的一个重要概念：“智能体护栏（Agentic Guardrails）”。简单讲，智能体护栏分两种：输入护栏和输出护栏。
4.2.1 输入护栏
输入护栏就是一层过滤网。它会检查所有被输入到系统里的内容，比如你发的消息、下的指令，是不是安全、是不是合适。举个例子，如果有人往系统里输一些暴力、违法之类的内容，这种护栏就会把它拦下来。还有，像是检查你有没有输入个人隐私信息（比如身份证号、手机号），防止这些敏感数据被乱用。甚至还有那种专门防止 “提示词注入” 的护栏，就是防止有人用奇怪的操作试图骗过或操控系统。还有输入格式的检查，比如你填表格，格式不对也不让过关。每个行业还会根据自己的需求设定独特的输入护栏，比如医疗系统就不让你问诊断类的问题，旅游助手可能只接受出行相关的查询。
4.2.2 输出护栏
输出护栏就是智能体说出来的话、给出的结果，也要被检查一遍。比如说，系统输出的内容不能涉及不良、违法或者带偏见的信息。如果系统说的是事实，还要有一套机制核查它说的是不是对的。有些护栏专门防止系统泄露用户的敏感信息，比如银行卡号、姓名之类的。还有的护栏负责检查输出的格式，保证给你的东西你能直接用，不会出错。再高级点，甚至会有另外一个模型来为输出结果“打分” ，帮忙判断这个回答到底靠不靠谱，有没有偏见、是不是说人话。
其实，输入和输出护栏这一套组合拳，就是为了让智能体系统别出乱子、别乱说话，也别泄露隐私，让大家能安心地用各种智能应用。


5. Agentops 智能体运维
衡量人工智能完成长期任务的能力：
Measuring AI Ability to Complete Long Tasks


6. 总分不平测试：
query:请给出01-10期间的总分不平记录。
answer:
================================================================================
【错误分类分析报告】
================================================================================
总计发现 176 条不平记录，分类如下：
- Type1 (恒定差额): 15 组
- Type2 (差额变化): 2 组
- Type3 (差额归零): 2 组
【Type1 - 恒定差额错误】
分析原因：6月1日起总账户与分户合计差额恒定，业务期间分户/总账同步变动。该总分不平发生在6月1日之前，建议您往6月1日前追溯原因。
判断标准：
1. 该组(org_num, sbj_num, ccy)在查询期间内所有日期都有记录
2. 所有日期的 tot_mint_dif 值完全相同（恒定差额）
3. 说明：可能存在系统性的余额计算错误或初始余额设置问题
共 15 组，详情：
  [1] 机构: 001170661, 科目: 01018114, 币种: DUS, 差额: -46867
  [2] 机构: 010770666, 科目: 01018114, 币种: DUS, 差额: -30500.89
  [3] 机构: 018070666, 科目: 01018114, 币种: DUS, 差额: -1461.3
  [4] 机构: 020070666, 科目: 01018114, 币种: DUS, 差额: 169808.51
  [5] 机构: 020070666, 科目: 01018114, 币种: YJP, 差额: -4594957
  [6] 机构: 080070666, 科目: 01018112, 币种: DUS, 差额: 48070
  [7] 机构: 080070666, 科目: 01018114, 币种: DUS, 差额: -376819.82
  [8] 机构: 100132058, 科目: 01018112, 币种: DUS, 差额: -48070
  [9] 机构: 100132060, 科目: 01018114, 币种: DUS, 差额: -2496.51
  [10] 机构: 100132070, 科目: 01018114, 币种: DUS, 差额: -9940
  [11] 机构: 100132110, 科目: 01018114, 币种: DUS, 差额: -4444.5
  [12] 机构: 200132058, 科目: 01018114, 币种: DUS, 差额: -5832.6
  [13] 机构: 300132058, 科目: 01018114, 币种: DUS, 差额: -8353.84
  [14] 机构: 500132058, 科目: 01018114, 币种: DUS, 差额: -8640
  [15] 机构: 610070666, 科目: 01018114, 币种: DUS, 差额: -8766.31
【Type2 - 差额变化错误】
分析原因：6月1日起总账户与分户合计产生差额不固定，业务期间分户/总账不同步变动。该总分不平发生在6月1日之前，同时中间又发生了新的错误，建议您对该账户的相关情况进行具体分析。
判断标准：
4. 在查询期间内，该组的 tot_mint_dif 值发生了至少一次变化
5. 存在多个不同的差额值（change_list 长度 ≥ 2）
6. 说明：可能在特定日期发生了交易或调整，导致差额发生变化
共 2 组，详情：
  [1] 机构: 001570661, 科目: 01018114, 币种: DUS
      变化点: 2 个，差额值: [-59809.2, -68097.2]
      变化日期: ['20250601', '20250610']
  [2] 机构: 100132058, 科目: 01018114, 币种: DUS
      变化点: 2 个，差额值: [-238268.54, -243415.2]
      变化日期: ['20250601', '20250609']
【Type3 - 差额归零错误】
分析原因：账户部分天数总分平衡，部分天数总分不平。建议借助平衡法则“当天余额=上一天余额±借方发生额±贷方发生额”进行计算找到错误
判断标准：
7. 该组在查询期间内不是所有日期都有记录（非全量）
8. 不平记录数少于总天数，但大于0
9. 存在一个日期范围（zero_span），在这个范围内差额从非零变为零
10. 说明：可能在某段时间内发生了错误，之后被纠正或自动归零
共 2 组，详情：
  [1] 机构: 100132040, 科目: 01178107, 币种: YCN
      异常日期范围: 20250606 至 20250608
  [2] 机构: 220070667, 科目: 01228107, 币种: YCN
      异常日期范围: 20250601 至 20250603
================================================================================
开始逐组验证...
================================================================================

---
【处理完成 - TYPE3】

---
机构: 100132040, 科目: 01178107, 币种: YCN, 日期: 20250606
【错误原因分析】
Type3 - 差额归零错误：
  账户部分天数总分平衡，部分天数总分不平。
  可能原因：
    1. 在某段时间内发生了错误，之后被纠正
    2. 可能存在红蓝字冲销操作
    3. 数据在异常期间后自动归零
  异常日期范围: 20250606 至 20250608
【冲销凭证分析】
  【冲销嫌疑匹配分析】期间 20250606–20250608：共 588 笔凭证，3 条差异记录；发现 6 组凭证金额与当日总差异高度吻合（误差 < 0.001）。
  → 
【冲销嫌疑匹配详情】
11. 🔴 R 凭证 99C787010783 | 日期 20250606 | 金额 -99.77 ≈ 差异 -99.77 (差值 0.0000)
12. 🔴 R 凭证 99C787010783 | 日期 20250606 | 金额 -99.77 ≈ 差异 -99.77 (差值 0.0000)
13. 🔴 R 凭证 99C787010783 | 日期 20250606 | 金额 -99.77 ≈ 差异 -99.77 (差值 0.0000)
14. 🔴 R 凭证 CL0100023864 | 日期 20250606 | 金额 -99.77 ≈ 差异 -99.77 (差值 0.0000)
15. 🔴 R 凭证 CL0100023864 | 日期 20250606 | 金额 -99.77 ≈ 差异 -99.77 (差值 0.0000)
16. 🔴 R 凭证 CL0100023864 | 日期 20250606 | 金额 -99.77 ≈ 差异 -99.77 (差值 0.0000)
【验证结果汇总】
  History表(传票发生额):
    - 账户数: 144
    - 总借方: 2662.88
    - 总贷方: 5661.39
    - 总差额: -2998.51
  Individual表(分户余额差):
    - 账户数: 144
    - 总差额: -2362.03
【可疑账户列表 - 共 78 个账户不一致】
  账户号 | History差额 | Individual差额 | 差异值 | 错误率

---
  0080a6a7-175d-4958-9db1-d061314c5ace | 1.74 | 1.73 | 0.01 | 0.57%
  00eee42a-9073-4446-be4a-aab9dfb9bfb9 | 10.64 | 8.57 | 2.07 | 19.45%
  0516890e-67d8-496b-8a73-9867b0037d29 | 32.59 | 32.58 | 0.01 | 0.03%
  0546c7b7-7022-4c9c-9de7-e217b3c10754 | 16.90 | 16.86 | 0.04 | 0.24%
  0c24ba0d-f98f-41a8-b025-9eceb596a780 | 5.62 | 5.53 | 0.09 | 1.60%
  0cc99ffc-c4ff-4d5c-aa5d-b881333326a4 | 1.17 | 1.15 | 0.02 | 1.71%
  0ea5de93-0a87-4f9a-9a7c-222dd41ba6fc | 1.21 | 1.20 | 0.01 | 0.83%
  0ed5defa-6290-4271-94b0-c261cc08c0ad | 1.08 | 1.01 | 0.07 | 6.48%
  0ef50f5e-4221-4d8c-9ad2-b553cd486e89 | 3.76 | 3.70 | 0.06 | 1.60%
  0f7e8320-6f0b-45c2-8ed6-85fa8d89316d | 50.29 | 50.31 | -0.02 | 0.04%
  1147c287-40e1-4000-b4f4-6b3b4eb4370a | 38.24 | 38.22 | 0.02 | 0.05%
  12cf0569-8168-4090-8249-f782c63ddf8b | 1.13 | 1.15 | -0.02 | 1.77%
  135b76ea-628c-4b9c-a5ee-103d5dc2d06c | 32.30 | 32.31 | -0.01 | 0.03%
  153c727c-4bc6-4711-b300-dd20d96910ba | 16.26 | 16.25 | 0.01 | 0.06%
  164c0937-6cf7-40de-bc45-accee2339d3e | 1.27 | 1.25 | 0.02 | 1.57%
  228f7ffb-2591-40cd-8827-f6168992d353 | 0.55 | 0.49 | 0.06 | 10.91%
  232eb7b7-c31f-4d1c-ac37-c987fb013cc1 | 12.51 | 12.54 | -0.03 | 0.24%
  25c8a5bd-d639-4846-a3fa-c5bd85ee639f | 3.78 | 3.81 | -0.03 | 0.79%
  27f4cf5c-2ca4-4955-99f8-d9b376e547c6 | 11.62 | 5.68 | 5.94 | 51.12%
  2918ad1c-b94f-4c2d-bb10-3dbc45b70aea | 0.70 | 0.68 | 0.02 | 2.86%
  ... 还有 58 个账户未显示
【可疑的History记录列表】
  账户号 | 借方金额 | 贷方金额 | 余额差

---
  0080a6a7-175d-4958-9db1-d061314c5ace | 1.74 | 0.00 | 1.74
  00eee42a-9073-4446-be4a-aab9dfb9bfb9 | 10.64 | 0.00 | 10.64
  0516890e-67d8-496b-8a73-9867b0037d29 | 32.59 | 0.00 | 32.59
  0546c7b7-7022-4c9c-9de7-e217b3c10754 | 16.90 | 0.00 | 16.90
  0c24ba0d-f98f-41a8-b025-9eceb596a780 | 5.62 | 0.00 | 5.62
  0cc99ffc-c4ff-4d5c-aa5d-b881333326a4 | 1.17 | 0.00 | 1.17
  0ea5de93-0a87-4f9a-9a7c-222dd41ba6fc | 1.21 | 0.00 | 1.21
  0ed5defa-6290-4271-94b0-c261cc08c0ad | 1.08 | 0.00 | 1.08
  0ef50f5e-4221-4d8c-9ad2-b553cd486e89 | 3.76 | 0.00 | 3.76
  0f7e8320-6f0b-45c2-8ed6-85fa8d89316d | 50.29 | 0.00 | 50.29
【可疑的Individual记录列表】
  账户号 | 上日余额 | 本日余额 | 余额差

---
  0080a6a7-175d-4958-9db1-d061314c5ace | -490.87 | -492.60 | -1.73
  00eee42a-9073-4446-be4a-aab9dfb9bfb9 | -2726.71 | -2735.28 | -8.57
  0516890e-67d8-496b-8a73-9867b0037d29 | -4091.41 | -4123.99 | -32.58
  0546c7b7-7022-4c9c-9de7-e217b3c10754 | -4620.17 | -4637.03 | -16.86
  0c24ba0d-f98f-41a8-b025-9eceb596a780 | -1480.37 | -1485.90 | -5.53
  0cc99ffc-c4ff-4d5c-aa5d-b881333326a4 | -78.65 | -79.80 | -1.15
  0ea5de93-0a87-4f9a-9a7c-222dd41ba6fc | -260.02 | -261.22 | -1.20
  0ed5defa-6290-4271-94b0-c261cc08c0ad | -224.92 | -225.93 | -1.01
  0ef50f5e-4221-4d8c-9ad2-b553cd486e89 | -921.97 | -925.67 | -3.70
  0f7e8320-6f0b-45c2-8ed6-85fa8d89316d | -18861.98 | -18912.29 | -50.31

---

---

7. 知识库问答测试：
Q为问题，M是我们系统回答，A是标准答案
Q1：一级科目、二级科目、三级科目的编码长度分别是多少？请举例说明三级科目编码的构成，同时说明表外科目在核心系统中的编码规则是什么？
M1：在会计科目编码中，一级科目、二级科目、三级科目的编码长度分别是：一级科目4位，二级科目6位，三级科目8位。具体的编码构成方式是：一级科目由4位数字组成，二级科目在一级科目的基础上增加2位数字，三级科目则在二级科目基础上再增加2位数字，从而构成8位的三级科目编码。例如，1001表示一级科目“现金”，100103表示二级科目“自助设备占款”，10010301表示三级科目“在行式 ATM 占款”，10010302表示另一个三级科目“离行式 ATM 占款”。对于表外科目，编码规则为“3+2+2”，即表外科目的编码在核心系统中会自动加上一个数字“8”来区分，表外科目传送给大总账时会去除这个“8”，恢复到“3+2+2”的格式
A1：一级科目4位、二级科目6位、三级科目8位；举例：一级科目1001（现金），二级科目100103（自助设备占款），三级科目10010301（在行式ATM占款），编码规则为“一级4位+二级2位+三级2位”；表外科目原格式为3+2+2，核心系统接收时自动在前方增加数字“8”，日终向大总账供数时去除“8”。
 
Q2：内部户账号的编码规则是什么？由哪几部分组成？请举一个具体示例。同时说明内部户控制表中“联机更新标志”设为“N”时，余额红字标识必须满足什么要求？
M2：内部户账号的编码规则由四部分组成：核算机构（9位）+币别（3位）+科目号（8位）+序号（6位）。具体示例为：010000000 156 10010302 000001，其中“010000000”代表核算机构， “156”代表币别， “10010302”代表科目号，“000001”是序号，表示该内部户的唯一标识。关于内部户控制表中“联机更新标志”设为“N”时，余额红字标识必须设为“Y”，即当联机更新标志为“不允许联机更新”时，余额红字标识必定要为“允许”，否则会导致系统错误
A2：内部户账号为26位字符型数字，编码规则为“核算机构（9位）+币别（3位）+科目号（8位）+序号（6位）”；示例：01000000015610010302000001（核算机构010000000、币别156、科目号10010302、序号000001）；“联机更新标志”为“N”时，余额红字标识必须设为“Y”。
 
Q3：科目状态分为哪几类？科目从“正常”转为“停用”的触发条件是什么？停用后对应的内部户会如何处理？
M3：科目状态分为“待生效”、“正常”、“停用”和“注销”四类。科目从“正常”转为“停用”的触发条件是当科目的失效日期到达或通过系统触发的停用操作。停用后的科目会对其下的内部户产生影响，如果该科目下的内部户余额为0，则该内部户会被注销；如果余额不为0，则该内部户将被置为“停用”状态，并且只能在余额为0的方向进行交易，直到余额清零后再进行注销操作
A3：科目状态包括待生效、正常、停用、注销；触发条件：科目失效日期日始自动停用，或手动发起停用交易。内部户处理：若内部户余额为0则注销，余额不为0则置为停用状态；每日批次检查停用内部户，余额为0时转为注销。
 
Q4：内部户挂销账的种类有哪些？“一挂多销”转为“一挂一销”需要满足什么前提条件？挂账编号的编码规则是什么？
M4：内部户挂销账的种类包括“一挂一销”、“一挂多销”、“多挂一销”和“多挂多销”。“一挂多销”转为“一挂一销”需要满足的前提条件是账户余额必须为0，且挂账记录必须已结清。挂账编号的编码规则为：9位机构号+6位年月日+3位序号，形成18位长度的唯一标识。例如，挂账编号“711111110 160330 001”表示机构号为711111110，日期为2016年3月30日，序号为001的挂账记录。
A4：挂销账种类包括一挂一销、一挂多销、多挂一销、多挂多销；前提条件：账户余额为0，且该挂账编号下所有挂账记录已清零结清；挂账编号编码规则：9位机构号+6位年月日+3位序号，共18位字符型数字。
 
Q5：增值税的税率代码有哪些？对应的适用业务类型分别是什么？价税分离的核心计算公式是什么？
M5：增值税的税率代码包括VAT001、VAT002、VAT003和VAT004，分别对应的适用业务类型为：VAT001适用于国债、地方债利息收入，金融同业往来利息收入、系统内拆放利息收入；VAT002适用于直接收费金融服务、金融商品转让、贷款服务；VAT003适用于投资性房地产租赁收入；VAT004适用于自营/代销贵金属收入，包括工本费收入如出售凭证、对账单、Ukey等工本费。价税分离的核心计算公式是：税额 = 含税总额 * 增值税率 /（1 + 增值税率），含税总额 = 税额 + 不含税额
A5：税率代码及适用业务：1.VAT001（0%）：国债/地方债利息收入、金融同业往来利息收入；2.VAT002（6%）：直接收费金融服务、贷款服务、金融商品转让；3.VAT003（11%）：投资性房地产租赁收入；4.VAT004（17%）：自营/代销贵金属收入、工本费收入。计算公式：税额=含税总额×增值税率÷（1+增值税率），含税总额=税额+不含税额。
 
Q6：手工记账仅允许对哪些类型的账户进行操作？不支持哪些机构层级的核算？手工传票的表内科目和表外科目在借贷平衡要求上有何区别？
M6：手工记账仅允许对内部户和纯科目进行操作，不支持对外部账户进行手工记账。手工记账不支持机构属性为分理处的核算机构。手工传票的表内科目要求借贷平衡，即按账务机构、货币、起息日借贷平衡，而表外科目则不要求借贷平衡。
A6：允许记账的账户：内部户（分户标识为“Y”）、纯科目（分户标识为“G”）；不支持的机构层级：分理处（仅挂靠上级支行核算，不独立开立内部户）。平衡要求区别：表内科目需按账套、机构、货币、起息日借贷平衡；表外科目采用单式记账，不要求借贷平衡。
 
Q7：总账横向平衡检查和纵向平衡检查的核心公式分别是什么？纵向平衡检查仅适用于哪种记账方式的科目？
M7：总账横向平衡检查的核心公式为：上日贷方余额 - 上日借方余额 + 当日贷方发生额 - 当日借方发生额 = 当日贷方余额 - 当日借方余额。总账纵向平衡检查的核心公式为：上日借方余额合计 = 上日贷方余额合计；本日借方发生额合计 = 本日贷方发生额合计；本日借方余额合计 = 本日贷方余额合计。纵向平衡检查仅适用于复式记账方式的科目。
A7：横向平衡检查公式：当日贷方余额-当日借方余额-上日贷方余额+上日借方余额-当日贷方发生额+当日借方发生额=0；纵向平衡检查公式：上日借方余额合计=上日贷方余额合计、本日借方发生额合计=本日贷方发生额合计、本日借方余额合计=本日贷方余额合计。纵向平衡检查仅适用于复式记账（R类）科目。
 
Q8：银行的科目账户种类及其借贷方向
M8：银行的科目账户种类包括资产类、负债类、资产负债共同类、所有者权益类、损益类和表外类。每种科目账户的借贷方向不同：资产类账户的借方反映增加，贷方反映减少；负债类账户的贷方反映增加，借方反映减少；资产负债共同类账户的借贷方向根据具体情况而定；所有者权益类账户的贷方反映增加，借方反映减少；损益类账户的借方反映费用或损失，贷方反映收入或收益；表外类账户通常采用单式记账，借贷方向不要求平衡
A8：科目账户按类别可分为7类：资产类（核算现金、ATM占款等银行资源，如1001“现金”）、负债类（核算客户存款等银行义务，如2001“单位活期存款”）、资产负债共同类（核算跨系统往来等双向业务，如300408“跨系统往来”）、所有者权益类（核算实收资本、本年利润等，如4001“实收资本”）、或有资产负债类（核算担保等潜在资产/负债）、损益类（核算利息收入、费用支出等，如5001“利息收入”）、表外类（核算重要单证等，如8001“银行承兑汇票”）；借贷方向规则为：资产类、损益类中的费用支出类，借方记增加、贷方记减少；负债类、所有者权益类、损益类中的收入收益类，贷方记增加、借方记减少；资产负债共同类按借贷轧差反映余额；或有资产负债类按业务性质分记借贷；表外类采用单式记账，不强制借贷平衡，且仅最底层科目（3级科目，8位编码）可实际核算记账。
