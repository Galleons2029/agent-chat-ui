---
alwaysApply: true
---

# Git Commit Standards

## Commit Message Format

This project follows the Conventional Commits specification with emoji prefixes:

```
<emoji> <type>(<scope>): <subject>

<body>

<footer>
```

### Required Elements
- **Emoji**: Visual indicator of change type (required)
- **Type**: Conventional commit type (required)
- **Scope**: Area of codebase affected (optional but recommended)
- **Subject**: Short description in imperative mood (required, max 72 chars)
- **Body**: Detailed explanation (optional)
- **Footer**: Breaking changes, issue references (optional)

## Commit Types and Emojis

| Type | Emoji | Description | Example |
|------|-------|-------------|---------|
| `feat` | âœ¨ | New feature | âœ¨ feat(ui): add dark mode toggle |
| `fix` | ğŸ› | Bug fix | ğŸ› fix(stream): prevent null pointer error |
| `docs` | ğŸ“š | Documentation | ğŸ“š docs: update setup instructions |
| `style` | ğŸ’„ | Code style/formatting | ğŸ’„ style(components): format with prettier |
| `refactor` | â™»ï¸ | Code refactoring | â™»ï¸ refactor(hooks): simplify useStream logic |
| `perf` | âš¡ | Performance improvement | âš¡ perf(markdown): optimize rendering |
| `test` | ğŸ§ª | Tests | ğŸ§ª test(api): add stream integration tests |
| `build` | ğŸ“¦ | Build system | ğŸ“¦ build: update next.js to 15.5 |
| `ci` | ğŸ‘· | CI/CD | ğŸ‘· ci: add deployment workflow |
| `chore` | ğŸ”§ | Maintenance | ğŸ”§ chore: update dependencies |
| `revert` | âª | Revert changes | âª revert: rollback stream changes |

### Additional Emojis

#### Features and Enhancements
- ğŸ¨ Improve UI/UX
- ğŸš€ Deploy or release
- ğŸ”¥ Remove code or files
- âœ… Add/update tests
- ğŸ”’ Fix security issues

#### Code Quality
- ğŸ§¹ Clean up code
- ğŸ“ Add/update comments
- ğŸ—ï¸ Architectural changes
- ğŸ”¨ Refactor code

#### Dependencies and Configuration
- â¬†ï¸ Upgrade dependencies
- â¬‡ï¸ Downgrade dependencies
- â• Add dependency
- â– Remove dependency
- âš™ï¸ Change configuration

#### LangGraph Specific
- ğŸ¤– AI/LLM features
- ğŸ’¬ Chat/messaging features
- ğŸ”„ Stream handling
- ğŸ“¡ API integration
- ğŸ­ Agent behavior

## Scope Guidelines

Common scopes for this project:

### Core Application
- `app` - Next.js app router and pages
- `api` - API routes and proxy
- `providers` - React context providers
- `hooks` - Custom React hooks

### UI Components
- `components` - General components
- `ui` - shadcn/ui components
- `thread` - Chat thread components
- `messages` - Message components
- `artifacts` - Artifact system

### Features
- `stream` - LangGraph streaming
- `chat` - Chat interface
- `markdown` - Markdown rendering
- `charts` - Chart components
- `mermaid` - Mermaid diagrams
- `custom-components` - Custom component system

### Infrastructure
- `config` - Configuration files
- `build` - Build process
- `deps` - Dependencies
- `docker` - Docker setup
- `ci` - CI/CD

### Documentation
- `docs` - Documentation files
- `readme` - README updates
- `examples` - Example code

## Subject Guidelines

- Use imperative mood: "add" not "added" or "adds"
- Don't capitalize first letter
- No period at the end
- Be concise but descriptive
- Maximum 72 characters

### Good Examples
```
âœ¨ feat(chat): add file upload support
ğŸ› fix(stream): handle connection timeout
ğŸ“š docs(api): document authentication flow
â™»ï¸ refactor(components): extract message logic
âš¡ perf(markdown): lazy load syntax highlighter
```

### Bad Examples
```
# Missing emoji
feat(chat): Added file upload  âŒ

# Wrong tense
âœ¨ feat(chat): Added file upload  âŒ

# Too vague
ğŸ› fix: bug fix  âŒ

# Too long
âœ¨ feat(ui): add comprehensive support for uploading multiple files with preview and progress tracking  âŒ

# Capitalized
âœ¨ feat(chat): Add file upload  âŒ

# Has period
âœ¨ feat(chat): add file upload.  âŒ
```

## Body Guidelines

- Separate from subject with blank line
- Wrap at 100 characters per line
- Explain **what** and **why**, not how
- Use bullet points for multiple changes
- Use present tense

### Example
```
âœ¨ feat(custom-components): add chart component support

- Add ECharts integration for interactive charts
- Support line, bar, pie, and scatter chart types
- Include responsive design and dark mode support
- Add type-safe configuration interface

This enables agents to send chart data that will be
rendered as interactive visualizations in the chat.
```

## Footer Guidelines

### Breaking Changes
```
BREAKING CHANGE: rename useStream to useStreamContext

This change requires updating all imports:
- import { useStream } becomes import { useStreamContext }
```

### Issue References
```
Closes: #123
Fixes: #456
Refs: #789
```

### Multiple Footers
```
BREAKING CHANGE: update message format

Closes: #123
Refs: #456
```

## Examples by Category

### Feature Development
```
âœ¨ feat(artifacts): add side panel artifact support

ğŸ¨ feat(ui): implement dark mode with theme switcher

ğŸ¤– feat(agent): add support for tool approval interrupts

ğŸ’¬ feat(chat): support multimodal content with images
```

### Bug Fixes
```
ğŸ› fix(stream): prevent duplicate message rendering

ğŸ› fix(markdown): escape HTML in code blocks

ğŸ”’ fix(auth): validate API key before connection
```

### Performance
```
âš¡ perf(components): memoize expensive message renders

âš¡ perf(stream): reduce re-renders with useMemo

ğŸš€ perf(build): enable React compiler optimization
```

### Refactoring
```
â™»ï¸ refactor(providers): extract thread logic to hook

â™»ï¸ refactor(messages): unify AI and human message components

ğŸ§¹ refactor(utils): remove unused helper functions
```

### Dependencies
```
â¬†ï¸ build(deps): upgrade next.js to 15.5.6

â• build(deps): add mermaid for diagram support

ğŸ“¦ build: update all dependencies to latest
```

### Documentation
```
ğŸ“š docs: add LangGraph integration guide

ğŸ“š docs(readme): update production deployment steps

ğŸ“ docs(components): add JSDoc comments to hooks
```

## Automated Validation

### Pre-commit Hook
Create `.git/hooks/commit-msg`:

```bash
#!/usr/bin/env bash
msg_file="$1"
pattern='^(âœ¨|ğŸ›|ğŸ“š|ğŸ’„|â™»ï¸|âš¡|ğŸ§ª|ğŸ“¦|ğŸ‘·|ğŸ”§|âª|ğŸ¨|ğŸš€|ğŸ”¥|âœ…|ğŸ”’|ğŸ§¹|ğŸ“|ğŸ—ï¸|ğŸ”¨|â¬†ï¸|â¬‡ï¸|â•|â–|âš™ï¸|ğŸ¤–|ğŸ’¬|ğŸ”„|ğŸ“¡|ğŸ­)\s+(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\([a-z0-9\-,]+\))?(!)?:\s.{1,72}$'

if ! grep -Eq "$pattern" "$msg_file"; then
  echo "âŒ Invalid commit message format"
  echo "See .cursor/rules/commit-standards.mdc for guidelines"
  exit 1
fi
```

Make it executable:
```bash
chmod +x .git/hooks/commit-msg
```

## Best Practices

1. **Atomic commits**: One logical change per commit
2. **Test before commit**: Ensure code builds and tests pass
3. **Review your diff**: Check what you're actually committing
4. **Write for others**: Assume readers don't have context
5. **Link issues**: Reference relevant issues and PRs
6. **Breaking changes**: Always document in footer
7. **Conventional format**: Follow the format strictly
8. **Meaningful scopes**: Use scopes that match the codebase structure

## Multi-language Considerations

- **Subject line**: English (for global collaboration)
- **Body**: English or Chinese (team preference)
- **Code comments**: Match language of surrounding code
- **Documentation**: Primary language English, translations welcome

## Commit Frequency

- Commit often during development
- Squash/rebase before merging to main
- Keep main branch history clean and linear
- Each merged commit should be functional
